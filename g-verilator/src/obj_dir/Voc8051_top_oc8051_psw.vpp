`begin_keywords "1800-2012"
`line 1 "oc8051_psw.v" 1
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

`line 44 "oc8051_psw.v" 0
 

`line 46 "oc8051_psw.v" 0
 
 
 

`line 50 "oc8051_psw.v" 0
 
 

`line 53 "oc8051_psw.v" 0
 
 

`line 56 "oc8051_psw.v" 0
 
 

`line 59 "oc8051_psw.v" 0
 
 




`line 65 "oc8051_psw.v" 0
 
 
`line 66 "oc8051_psw.v" 0
`line 1 "oc8051_timescale.v" 1

`line 3 "oc8051_timescale.v" 0

`line 3 "oc8051_timescale.v" 0
`timescale 1ns/10ps

`line 5 "oc8051_timescale.v" 2
`line 66 "oc8051_psw.v" 0

`line 67 "oc8051_psw.v" 0
 

`line 69 "oc8051_psw.v" 0
 
`line 69 "oc8051_psw.v" 0
`line 1 "oc8051_defines.v" 1
 
`line 2 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

`line 45 "oc8051_defines.v" 0
 



`line 49 "oc8051_defines.v" 0
 

`line 51 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 



`line 63 "oc8051_defines.v" 0
 

`line 65 "oc8051_defines.v" 0
 



`line 69 "oc8051_defines.v" 0
 

`line 71 "oc8051_defines.v" 0
 
 
 
 
 


`line 78 "oc8051_defines.v" 0
 

`line 80 "oc8051_defines.v" 0
 
 


`line 84 "oc8051_defines.v" 0
 



`line 88 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 


`line 106 "oc8051_defines.v" 0
 


`line 109 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

`line 127 "oc8051_defines.v" 0
 
 
 
 

`line 132 "oc8051_defines.v" 0
 
 



`line 137 "oc8051_defines.v" 0
 
 

`line 140 "oc8051_defines.v" 0
 
 

`line 143 "oc8051_defines.v" 0
 
 
 

`line 147 "oc8051_defines.v" 0
 
 




`line 153 "oc8051_defines.v" 0
 

`line 155 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 
 
 
 



`line 170 "oc8051_defines.v" 0
 

`line 172 "oc8051_defines.v" 0
 
 
 
 
 


`line 179 "oc8051_defines.v" 0
 


`line 182 "oc8051_defines.v" 0
 
 
 

`line 186 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

`line 204 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

`line 224 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 


`line 304 "oc8051_defines.v" 0
 

`line 306 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



`line 331 "oc8051_defines.v" 0
 
 

`line 334 "oc8051_defines.v" 0
 
 
 
 



`line 341 "oc8051_defines.v" 0
 

`line 343 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 


`line 353 "oc8051_defines.v" 0
 

`line 355 "oc8051_defines.v" 0
 
 
 
 

`line 360 "oc8051_defines.v" 0
 


`line 363 "oc8051_defines.v" 0
 

`line 365 "oc8051_defines.v" 0
 
 
 
 



`line 372 "oc8051_defines.v" 0
 

`line 374 "oc8051_defines.v" 0
 
 
 
 



`line 381 "oc8051_defines.v" 0
 


`line 384 "oc8051_defines.v" 0
 
 
 
 

`line 389 "oc8051_defines.v" 0
 
 
 
 

`line 394 "oc8051_defines.v" 0
 


`line 397 "oc8051_defines.v" 0
 


`line 400 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 


`line 410 "oc8051_defines.v" 0
 

`line 412 "oc8051_defines.v" 0
 
 
 
 
 
 
 
 
 


`line 423 "oc8051_defines.v" 0
 

`line 425 "oc8051_defines.v" 0
 
 
 
 
 



`line 433 "oc8051_defines.v" 0
 

`line 435 "oc8051_defines.v" 0
 
 


`line 439 "oc8051_defines.v" 0
 

`line 441 "oc8051_defines.v" 0
 
 
 
 


`line 447 "oc8051_defines.v" 0
 

`line 449 "oc8051_defines.v" 0
 
 

`line 452 "oc8051_defines.v" 0
 
 
 
 
 



`line 460 "oc8051_defines.v" 0
 

`line 462 "oc8051_defines.v" 0
 
 
 
 
 
 


`line 470 "oc8051_defines.v" 0
 


`line 473 "oc8051_defines.v" 0
 


`line 476 "oc8051_defines.v" 0
 
 
 
 



`line 483 "oc8051_defines.v" 0
 


`line 486 "oc8051_defines.v" 0
 
 
 
 
 
 



`line 495 "oc8051_defines.v" 0
 


`line 498 "oc8051_defines.v" 0
 
 


`line 502 "oc8051_defines.v" 0
 

`line 504 "oc8051_defines.v" 0
 
 
 
 
 
 
 




`line 515 "oc8051_defines.v" 0
 


`line 518 "oc8051_defines.v" 0
 
 


`line 522 "oc8051_defines.v" 0
 

`line 524 "oc8051_defines.v" 0
 
 


`line 528 "oc8051_defines.v" 0
 


`line 531 "oc8051_defines.v" 0
 
 


`line 535 "oc8051_defines.v" 2
`line 69 "oc8051_psw.v" 0



`line 72 "oc8051_psw.v" 0
module oc8051_psw (clk, rst, wr_addr, data_in, wr, wr_bit, data_out, p,
                cy_in, ac_in, ov_in, set, bank_sel, psw_next);

`line 75 "oc8051_psw.v" 0
 
 
 
 
 
 
 
 
 
 
 



`line 89 "oc8051_psw.v" 0
input clk, rst, wr, p, cy_in, ac_in, ov_in, wr_bit;
input [1:0] set;
input [7:0] wr_addr, data_in;

`line 93 "oc8051_psw.v" 0
output [1:0] bank_sel;
output [7:0] data_out;
output [7:0] psw_next;

`line 97 "oc8051_psw.v" 0
reg [7:1] data;
wire wr_psw;

`line 100 "oc8051_psw.v" 0
assign wr_psw = (wr & (wr_addr==8'hd0) && !wr_bit);

`line 102 "oc8051_psw.v" 0
assign bank_sel = wr_psw ? data_in[4:3]:data[4:3];
assign data_out = {data[7:1], p};

`line 105 "oc8051_psw.v" 0
reg [7:1] psw_next_i;
wire [7:0] psw_next = {psw_next_i, p};

`line 108 "oc8051_psw.v" 0
 
always @(data or wr or wr_bit or wr_addr or cy_in or data_in or set or ov_in or ac_in)
begin
    psw_next_i = data;

`line 113 "oc8051_psw.v" 0
    if (wr & (wr_bit==1'b0) & (wr_addr==8'hd0))
      psw_next_i[7:1] = data_in[7:1];

`line 116 "oc8051_psw.v" 0
 
    else if (wr & wr_bit & (wr_addr[7:3]==5'b11010))
      psw_next_i[wr_addr[2:0]] = cy_in;
    else begin
      case (set) 
        2'b01: begin

`line 123 "oc8051_psw.v" 0
 
          psw_next_i[7] = cy_in;
        end
        2'b10: begin

`line 128 "oc8051_psw.v" 0
 
          psw_next_i[7] = cy_in;
          psw_next_i[2] = ov_in;
        end
        2'b11:begin

`line 134 "oc8051_psw.v" 0
 
          psw_next_i[7] = cy_in;
          psw_next_i[6] = ac_in;
          psw_next_i[2] = ov_in;
        end
      endcase
    end
end


`line 144 "oc8051_psw.v" 0
 
always @(posedge clk or posedge rst)
begin
  if (rst)
    data <= #1 8'h00;


`line 151 "oc8051_psw.v" 0
 
  else begin
    if (wr & (wr_bit==1'b0) & (wr_addr==8'hd0))
      data[7:1] <= #1 data_in[7:1];

`line 156 "oc8051_psw.v" 0
 
    else if (wr & wr_bit & (wr_addr[7:3]==5'b11010))
      data[wr_addr[2:0]] <= #1 cy_in;
    else begin
      case (set) 
        2'b01: begin

`line 163 "oc8051_psw.v" 0
 
          data[7] <= #1 cy_in;
        end
        2'b10: begin

`line 168 "oc8051_psw.v" 0
 
          data[7] <= #1 cy_in;
          data[2] <= #1 ov_in;
        end
        2'b11:begin

`line 174 "oc8051_psw.v" 0
 
          data[7] <= #1 cy_in;
          data[6] <= #1 ac_in;
          data[2] <= #1 ov_in;

`line 179 "oc8051_psw.v" 0
        end
      endcase
    end
  end
end

`line 185 "oc8051_psw.v" 0
endmodule

`line 187 "oc8051_psw.v" 2
