`begin_keywords "1800-2012"
`line 1 "oc8051_xram.v" 1
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

`line 44 "oc8051_xram.v" 0
 

`line 46 "oc8051_xram.v" 0
 
 
 

`line 50 "oc8051_xram.v" 0
 
 



`line 55 "oc8051_xram.v" 0
 
 
`line 56 "oc8051_xram.v" 0
`line 1 "oc8051_timescale.v" 1

`line 3 "oc8051_timescale.v" 0

`line 3 "oc8051_timescale.v" 0
`timescale 1ns/10ps

`line 5 "oc8051_timescale.v" 2
`line 56 "oc8051_xram.v" 0

`line 57 "oc8051_xram.v" 0
 


`line 60 "oc8051_xram.v" 0
module oc8051_xram (clk, rst, wr, wr_en, addr, data_in, data_out, ack, stb, rd_en);

`line 62 "oc8051_xram.v" 0
 
 

`line 65 "oc8051_xram.v" 0
 
 
 
 
 
 
 


`line 74 "oc8051_xram.v" 0
parameter DELAY=1;


`line 77 "oc8051_xram.v" 0
input clk, wr, wr_en, stb, rst, rd_en;
input [7:0] data_in;
input [15:0] addr;
output [7:0] data_out;
output ack;

`line 83 "oc8051_xram.v" 0
reg ackw, ackr;
reg [7:0] data_out;
reg [2:0] cnt;


`line 88 "oc8051_xram.v" 0
 
reg [7:0] buff [65535:0];   
 
 

`line 93 "oc8051_xram.v" 0
assign ack =  ackw || ackr;

`line 95 "oc8051_xram.v" 0
wire [15:0] addr0 = addr[15:0];

`line 97 "oc8051_xram.v" 0
/*verilator lint_off ASSIGNDLY*/ 

`line 99 "oc8051_xram.v" 0
 
always @(posedge clk)
begin
  if (rst)
    ackw <= #1 1'b0;
  else if (wr && wr_en && stb && ((DELAY==3'b000) || (cnt==3'b000))) begin
    buff[addr0] <= #1 data_in;
    ackw <= #1 1'b1;
  end else if (wr && stb && ((DELAY==3'b000) || (cnt==3'b000))) begin
    ackw <= #1 1'b1;
  end else ackw <= #1 1'b0;
end

`line 112 "oc8051_xram.v" 0
always @(posedge clk)
  if (rst)
    ackr <= #1 1'b0;
  else if (rd_en && stb && !wr && ((DELAY==3'b000) || (cnt==3'b000))) begin
    data_out <= #1 buff[addr0];
    ackr <= #1 1'b1;
  end else if (stb && !wr && ((DELAY==3'b000) || (cnt==3'b000))) begin
    ackr <= #1 1'b1;
    data_out <= #1 8'h00;
  end else begin
    ackr <= #1 1'b0;
    data_out <= #1 8'h00;
  end
integer i;
always @(posedge clk)
begin
  if (rst) begin
    cnt <= #1 DELAY;
    for (i=0; i < 65536; i+=1) begin
      buff[i] = 8'h00;
    end
  end else if (cnt==3'b000)
    cnt <= #1 DELAY;
  else if (stb)
    cnt <= #1 cnt - 3'b001;
  else cnt <= #1 DELAY;
end
/*verilator lint_on ASSIGNDLY*/ 


`line 142 "oc8051_xram.v" 0
endmodule

`line 144 "oc8051_xram.v" 2
